<!DOCTYPE html>
<html>
<head>
    <title>OnlyKey Configuration Wizard</title>
    <link rel="stylesheet" href="/stylesheets/style.css">

    <!-- Scripts giving you few extra things in NW.js -->
    <script src="/vendor/nw-boilerplate/darwin_menu.js"></script>
    <script src="/vendor/nw-boilerplate/env_config.js"></script>
    <script src="/vendor/nw-boilerplate/external_links.js"></script>
    <script src="/vendor/nw-boilerplate/window_state.js"></script>

    <!-- App dependencies -->
    <script src="/vendor/FileSaver.js"></script>
    <script src="/vendor/openpgp.min.js"></script>
</head>

<body>
    <i id="okVersionStr"></i>
	<div id="lastMessage">
		Last message received: <span></span>
        <ul>
            <li></li>
            <li></li>
        </ul>
    </div>
    <div id="main" class="hide">
		<h1>OnlyKey Setup</h1>

		<nav>
            <a id="show-init-panel" href="">PINs</a>
			<a id="show-slot-panel" href="" class="hide">Slots</a>
            <a id="show-keys-panel" href="" class="hide">Keys</a>
            <a id="show-backup-panel" href="" class="hide">Backup/Restore</a>
            <a id="show-pref-panel" href="" class="hide">Preferences</a>
		</nav>

        <form id="init-panel" name="init-panel" class="hide panel">
			<br/>
            <table border="1" cellpadding="5" cellspacing="0" id="HeaderTable">
                <tr>
                    <td data-step="Step1">Step 1: Getting Started</td>
                    <td data-step="Step2">Step 2: Select OnlyKey Edition</td>
                    <td data-step="Step3">Step 3: Set Your PIN</td>
                    <td data-step="Step4">Step 4: Confirm PIN</td>
                    <td data-step="Step5">Step 5: Set Self-Destruct PIN</td>
                    <td data-step="Step6">Step 6: Confirm Self-Destruct PIN</td>
                    <td data-step="Step7">Step 7: Set Plausible Deniability PIN</td>
                    <td data-step="Step8">Step 8: Confirm Plausible Deniability PIN</td>
                </tr>
            </table>

            <br />

            <div id="stepContent">
                <div class="step" id="Step1">
                    <h3>Welcome to the OnlyKey Initial Setup Wizard!</h3>
                    This wizard initializes the OnlyKey. Your current step is always highlighted in the header.
                    <br/><br />
                    Click [Next] to get started.
                </div>

                <div class="step" id="Step2">
                    <h3>Step 2: Select OnlyKey Edition</h3>
                    <b>Modes:</b>
                    <br/>
                    <label>
                        <input type="radio" checked name="ConfigMode" value="TwoFactor" />
                        Standard Edition (default for US customers)
                    </label>
                    <br/>
                    <label>
                        <input type="radio" name="ConfigMode" value="Unencrypted" />
                        International Travel Edition (default for international customers)
                    </label>
                    <br/><br/>
                </div>

                <div class="step" id="Step3">
                    <h3>Step 3: Enter PIN on OnlyKey keypad</h3>
                    <p>
                        WARNING &mdash; Make sure to choose a PIN that you will not forget and that only you know. It is also good to have a secure backup of your PIN somewhere just in case you forget.
                    </p>
                    <p>
                        DISCLAIMER &mdash; I understand that there is no way to recover my PIN and if I forget it the only way to recover the OnlyKey is to perform a factory default which wipes all sensitive information.
                    </p>
                    <label>
                        <input type="checkbox" name="passcode1Disclaimer" />
                        I understand and accept the above risk.
                    </label>
                    <p>
                        Enter a 7 - 10 digit PIN on your OnlyKey six button keypad and when you are finished click [Next] below.
                    </p>
                </div>

                <div class="step" id="Step4">
                    <h3>Step 4: Re-enter PIN on OnlyKey Keypad</h3>
                    <p>
                        Re-enter the 7 - 10 digit PIN on your OnlyKey six button keypad and when you are finished click [Next] below.
                    </p>
                </div>

                <div class="step" id="Step5">
                    <h3>Step 5. Enter self-destruct PIN on OnlyKey keypad</h3>
                    <p>
                        WARNING &mdash; Make sure to choose a PIN that you will not forget and that only you know. Also this PIN should not be similar to your regular PIN as this could result in unintentionally wiping your OnlyKey. It is your responsibility to maintain a secure backup of your PIN somewhere just in case you forget.
                    </p>
                    <p>
                        DISCLAIMER &mdash; I understand that entering this PIN will cause OnlyKey to perform a factory default which wipes all sensitive information.
                    </p>
                    <label>
                        <input type="checkbox" name="passcode2Disclaimer" />
                        I understand and accept the above risk.
                    </label>
                    <p>
                        Enter a 7 - 10 digit PIN on your OnlyKey six button keypad and when you are finished click [Next] below.
                    </p>
                </div>

                <div class="step" id="Step6">
                    <h3>Step 6: Re-enter Self-Destruct PIN on OnlyKey Keypad</h3>
                    <p>
                        Re-enter the 7 - 10 digit PIN on your OnlyKey six button keypad and when you are finished click confirm below.
                    </p>
                </div>

                <div class="step" id="Step7">
                    <h3>Step 7: Enter Plausible Deniability PIN on OnlyKey keypad</h3>
                    <p>
                        If you are using the Standard Edition (default for US customers) you may proceed to enter plausible deniability passcode.
                    </p>
                    <p>
                        WARNING &mdash; Make sure to choose a PIN that you will not forget and that only you know. It is your responsibility to maintain a secure backup of your PIN somewhere just in case you forget.
                    </p>
                    <p>
                        DISCLAIMER &mdash; I understand that entering this passcode will cause OnlyKey to load a second profile and appear as if I am using the Unencrypted Password Manager (International Version) firmware. This may be helpful if I am forced to give up my passcode in some situations; however, I understand that there is no level of safety guaranteed or implied and I am using this feature at my own risk.
                    </p>
                    <label>
                        <input type="checkbox" name="passcode3Disclaimer" />
                        I understand and accept the above risk.
                    </label>
                    <p>
                        Enter a 7 - 10 digit PIN on your OnlyKey six button keypad and when you are finished click submit below.
                    </p>
                </div>

                <div class="step" id="Step8">
                    <h3>Step 8: Re-enter Plausible Deniability PIN on OnlyKey Keypad</h3>
                    <p>
                       Re-enter the 7 - 10 digit PIN on your OnlyKey six button keypad and when you are finished click confirm below.
                    </p>
                </div>
            </div>

            <br />

            <table border="0" cellpadding="5" cellspacing="0">
                <tr>
                    <td>
                        <button id="ButtonPrevious" type="button" disabled="disabled">Previous</button>
                    </td>
                    <td>
                        <button id="ButtonNext" type="button">Next</button>
                    </td>
                </tr>
            </table>
        </form>

        <div id="slot-panel" class="hide panel">
            <div class="flex-container">
                <div class="flex-item">
                    <h2>Configure OnlyKey Slots</h2>
                    <table id="slot-config-btns">
                        <tr>
                            <td align="right">
                                <span class="slotLabel" id="slotLabel1a">empty</span>
                                <input type="button" id="slot1aConfig" value="1a"/><br/>
                                <span class="slotLabel" id="slotLabel1b">empty</span>
                                <input type="button" id="slot1bConfig" value="1b"/>
                            </td>
                            <td class="ok-photo-cell" rowspan="3"></td>
                            <td>
                                <input type="button" id="slot2aConfig" value="2a"/>
                                <span class="slotLabel" id="slotLabel2a">empty</span>
                                <br/>
                                <input type="button" id="slot2bConfig" value="2b"/>
                                <span class="slotLabel" id="slotLabel2b">empty</span>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <span class="slotLabel" id="slotLabel3a">empty</span>
                                <input type="button" id="slot3aConfig" value="3a"/><br/>
                                <span class="slotLabel" id="slotLabel3b">empty</span>
                                <input type="button" id="slot3bConfig" value="3b"/>
                            </td>
                            <td>
                                <input type="button" id="slot4aConfig" value="4a"/>
                                <span class="slotLabel" id="slotLabel4a">empty</span>
                                <br/>
                                <input type="button" id="slot4bConfig" value="4b"/>
                                <span class="slotLabel" id="slotLabel4b">empty</span>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <span class="slotLabel" id="slotLabel5a">empty</span>
                                <input type="button" id="slot5aConfig" value="5a"/><br/>
                                <span class="slotLabel" id="slotLabel5b">empty</span>
                                <input type="button" id="slot5bConfig" value="5b"/>
                            </td>
                            <td>
                                <input type="button" id="slot6aConfig" value="6a"/>
                                <span class="slotLabel" id="slotLabel6a">empty</span>
                                <br/>
                                <input type="button" id="slot6bConfig" value="6b"/>
                                <span class="slotLabel" id="slotLabel6b">empty</span>
                            </td>
                        </tr>
                    </table>

                    <form id="yubiAuthForm" name="yubiAuthForm" class="auth-form">
                        <h2>Add Yubikey Security Info</h2>
                        <label>
                            Public Identity (6 bytes modhex)
                            <br/>
                            <input type="text" id="yubiPublicId" name="yubiPublicId" maxlength="17" minlength="12" placeholder="public id" required/>
                        </label>
                        <br/>
                        <label>
                            Private Identity (6 bytes hex)
                            <br/>
                            <input type="text" id="yubiPrivateId" name="yubiPrivateId" maxlength="17" minlength="12" placeholder="private id" required/>
                        </label>
                        <br/>
                        <label>
                            Secret Key (16 bytes hex)
                            <br/>
                            <input type="text" id="yubiSecretKey" name="yubiSecretKey" maxlength="47" minlength="32" placeholder="secret aes key" required/>
                        </label>
                        <br/><br/>
                        <input type="button" id="yubiSubmit" name="yubiSubmit" value="Save to OnlyKey" />
                        <input type="button" id="yubiWipe" name="yubiWipe" value="Wipe from OnlyKey" />
                        <div id="yubiError" class="form-error"></div>
                    </form>
                </div>
                <div class="flex-item">
                    <form id="u2fAuthForm" name="u2fAuthForm" class="auth-form">
                        <h2>Add U2F Security Info</h2>
                        <label>
                            Private Identity (32 bytes hex)
                            <br/>
                            <textarea id="u2fPrivateId" name="u2fPrivateId" maxlength="95" minlength="64" cols="40" rows="10" placeholder="private id" required></textarea>
                        </label>
                        <br/>
                        <label>
                            U2F Certificate (up to 768 bytes hex)
                            <br/>
                            <textarea id="u2fCert" name="u2fCert" maxlength="3071" minlength="2" cols="40" rows="10" placeholder="certificate" required></textarea>
                        </label>
                        <br/><br/>
                        <input type="button" id="u2fSubmit" name="u2fSubmit" value="Save to OnlyKey" />
                        <input type="button" id="u2fWipe" name="u2fWipe" value="Wipe from OnlyKey" />
                        <div id="u2fError" class="form-error"></div>
                    </form>
                </div>
            </div>
        </div>

        <div id="pref-panel" class="hide panel">
            <div class="flex-container">
                <div class="flex-item">
					<form id="lockoutForm" name="lockoutForm">
						<h2>Inactivity Lockout Period</h2>
						Lockout time in minutes:
						<input type="number" id="okLockout" name="okLockout" min=1 max=255 placeholder="1-255" />
						<input type="button" id="lockoutSubmit" value="Set Lockout" />
						<br/>
						(1 &ndash; 255 minutes; default = 30; 0 to disable)
					</form>
					<br/>
					<form id="wipeModeForm" name="wipeModeForm">
						<h2>Wipe Mode</h2>
						<h3>Configure how the OnlyKey responds to<br/>a factory reset.</h3>
						<label>
							<input type="radio" checked name="okWipeMode" value=1 />
							<u>Sensitive Data Only</u> (default)
							<br/>All sensitive data is wiped.
						</label>
						<br/><br/>
						<label>
							<input type="radio" name="okWipeMode" value=2 />
							<u>Full Wipe</u> (recommended for plausible deniability users)
							<br/>Entire device is wiped. Firmware must be reloaded.
							<br/>
						</label>
						<br/>
						<span style="font-size: small; color: red;"><b>WARNING - Setting to Full Wipe mode cannot be changed.</b></span>
						<br/><br/>
						<input type="button" id="wipeModeSubmit" value="Set Wipe Mode" />
					</form>
				</div>

				<div class="flex-item">
					<form id="typeSpeedForm" name="typeSpeedForm">
						<h2>Keyboard Type Speed</h2>
						Choose a setting:
						<input type="number" id="okTypeSpeed" name="okTypeSpeed" min=1 max=10 placeholder="1-10" />
						<input type="button" id="typeSpeedSubmit" value="Set Type Speed" />
						<br/>
						(1 = slowest; 10 = fastest [4 = default])
					</form>
					<br/>
					<form id="keyboardLayoutForm" name="keyboardLayoutForm">
						<h2>Keyboard Layout</h2>
						Choose a keyboard layout:
						<select id="okKeyboardLayout" name="okKeyboardLayout">
							<option value=1>US_ENGLISH (default)</option>
							<option value=2>CANADIAN_FRENCH</option>
							<option value=3>CANADIAN_MULTILINGUAL</option>
							<option value=4>DANISH</option>
							<option value=5>FINNISH</option>
							<option value=6>FRENCH</option>
							<option value=7>FRENCH_BELGIAN</option>
							<option value=8>FRENCH_SWISS</option>
							<option value=9>GERMAN</option>
							<option value=10>GERMAN_MAC</option>
							<option value=11>GERMAN_SWISS</option>
							<option value=12>ICELANDIC</option>
							<option value=13>IRISH</option>
							<option value=14>ITALIAN</option>
							<option value=15>NORWEGIAN</option>
							<option value=16>PORTUGUESE</option>
							<option value=17>PORTUGUESE_BRAZILIAN</option>
							<option value=18>SPANISH</option>
							<option value=19>SPANISH_LATIN_AMERICA</option>
							<option value=20>SWEDISH</option>
							<option value=21>TURKISH</option>
							<option value=22>UNITED_KINGDOM</option>
							<option value=23>US_INTERNATIONAL</option>
							<option value=24>CZECH</option>
							<option value=25>SERBIAN_LATIN_ONLY</option>
						</select>
						<br/>
						<input type="button" id="kbdLayoutSubmit" value="Set Keyboard Layout" />
					</form>
				</div>
			</div>
        </div>

        <div id="keys-panel" class="hide panel">
            Hold the #6 button down on your OnlyKey for 5 seconds or more and then release. Your OnlyKey light will turn off and you must re-enter your PIN to unlock the device into config mode.

            <div class="flex-container">
                <div class="flex-item">
                    <form id="eccForm" name="eccForm" class="auth-form">
                        <h2>ECC Private Key (32 bytes hex)</h2>

                        <label>
                            Type:
                            <select id="eccType" name="eccType">
                                <option value=1>Curve25519/Ed25519</option>
                                <option value=2>NIST P256</option>
                                <option value=3>secp256k1</option>
                            </select>
                        </label>

                        <br/>
                        <br/>

                        <label>
                            Slot:
                            <select id="eccSlot" name="eccSlot">
                                <option value=101>1</option>
                                <option value=102>2</option>
                                <option value=103>3</option>
                                <option value=104>4</option>
                                <option value=105>5</option>
                                <option value=106>6</option>
                                <option value=107>7</option>
                                <option value=108>8</option>
                                <option value=109>9</option>
                                <option value=110>10</option>
                                <option value=111>11</option>
                                <option value=112>12</option>
                                <option value=113>13</option>
                                <option value=114>14</option>
                                <option value=115>15</option>
                                <option value=116>16</option>
                                <option value=117>17</option>
                                <option value=118>18</option>
                                <option value=119>19</option>
                                <option value=120>20</option>
                                <option value=121>21</option>
                                <option value=122>22</option>
                                <option value=123>23</option>
                                <option value=124>24</option>
                                <option value=125>25</option>
                                <option value=126>26</option>
                                <option value=127>27</option>
                                <option value=128>28</option>
                                <option value=129>29</option>
                                <option value=130>30</option>
                                <option value=131>31</option>
                                <option value=132>32</option>
                            </select>
                        </label>

                        <br/>
                        <br/>

                        <label>
                            Key:
                            <br/>
                            <textarea id="eccKey" name="eccKey" maxlength="64" minlength="64" cols="40" rows="10" placeholder="ECC Key (32 bytes hex)" required></textarea>
                        </label>

                        <br/>
                        <br/>

                        <label>
                            <input type="checkbox" id="eccSetAsBackup" name="eccSetAsBackup" value="true"/>
                            Set as backup key (only one backup may be set)
                        </label>

                        <br/>

                        <label>
                            <input type="checkbox" id="eccSetAsSignature" name="eccSetAsSignature" value="true"/>
                            Set as signature key
                        </label>

                        <br/>

                        <label>
                            <input type="checkbox" id="eccSetAsDecryption" name="eccSetAsDecryption" value="true"/>
                            Set as decryption key
                        </label>

                        <br/>

                        <label>
                            <input type="checkbox" id="eccSetAsAuthentication" name="eccSetAsAuthentication" value="true"/>
                            Set as authentication key
                        </label>

                        <br/>
                        <br/>

                        <input type="button" id="eccSubmit" name="eccSubmit" value="Save to OnlyKey" />
                        <input type="button" id="eccWipe" name="eccWipe" value="Wipe from OnlyKey" />
                        <div id="eccFormError" class="form-error"></div>
                    </form>
                </div>

                <div class="flex-item">
                    <form id="rsaForm" name="rsaForm" class="auth-form">
                        <h2>RSA Private Key (PEM Format)</h2>

                        <label>
                            Slot:
                            <select id="rsaSlot" name="rsaSlot">
                                <option value=1>1</option>
                                <option value=2>2</option>
                                <option value=3>3</option>
                                <option value=4>4</option>
                            </select>
                        </label>

                        <br/>
                        <br/>

                        <label>
                            Key:
                            <br/>
                            <textarea id="rsaKey" name="rsaKey" cols="40" rows="10" placeholder="RSA Key -- paste PEM file contents" required></textarea>
                        </label>

                        <br/>

                        <label>
                            Passphrase:
                            <input type="password" id="rsaPasscode" name="rsaPasscode" />
                        </label>
                        <br/>
                        <br/>

                        <label>
                            <input type="checkbox" id="rsaSetAsBackup" name="rsaSetAsBackup" value="true"/>
                            Set as backup key (only one backup may be set)
                        </label>

                        <br/>

                        <label>
                            <input type="checkbox" id="rsaSetAsSignature" name="rsaSetAsSignature" value="true"/>
                            Set as signature key
                        </label>

                        <br/>

                        <label>
                            <input type="checkbox" id="rsaSetAsDecryption" name="rsaSetAsDecryption" value="true"/>
                            Set as decryption key
                        </label>

                        <br/>

                        <label>
                            <input type="checkbox" id="rsaSetAsAuthentication" name="rsaSetAsAuthentication" value="true"/>
                            Set as authentication key
                        </label>

                        <br/>
                        <br/>

                        <input type="button" id="rsaSubmit" name="rsaSubmit" value="Save to OnlyKey" />
                        <input type="button" id="rsaWipe" name="rsaWipe" value="Wipe from OnlyKey" />
                        <div id="rsaFormError" class="form-error"></div>
                    </form>
                </div>
            </div>
        </div>

        <div id="backup-panel" class="hide panel">
            <div class="flex-container">
                <div class="flex-item">
                    <form id="backupForm" name="backupForm" class="auth-form">
                        <h2>Backup</h2>

                        <fieldset>
                            <p>
                                <u>Step 1</u>. To begin backup ensure that you have a backup key set (in the keys tab) and that you have an offline copy of this backup key. The same key that you use to backup your OnlyKey will be required to restore your OnlyKey.
                            </p>
                            <p>
                                <u>Step 2</u>. Click inside the box with your mouse and then hold the #1 button down on your OnlyKey for 5 seconds or more and then release. This will type out a backup of your OnlyKey slots and keys into the box.
                            </p>
                            <p>
                                <u>Step 3</u>. Once you see "-----END ONLYKEY BACKUP-----" the backup of the OnlyKey slots and keys is complete. Select "Save file" to save your encrypted backup to a secure location.
                            </p>
                        </fieldset>

                        <br/>

                        <label>
                            Backup data:
                            <br/>
                            <textarea id="backupData" name="backupData" cols="40" rows="10" placeholder="DO NOT type in this field. Click inside here, then hold your OnlyKey button #1 for 5+ seconds."></textarea>
                        </label>

                        <br/><br/>

                        <input type="button" id="backupSave" name="backupSave" value="Save file" />
                        <span id="lastBackupFilename">onlykey-backup-[timestamp].txt</span>
                        <div id="backupFormError" class="form-error"></div>
                    </form>
                </div>

                <div class="flex-item">
                    <form id="restoreForm" name="restoreForm" class="auth-form">
                        <h2>Restore</h2>

                        <fieldset>
                            <p>
                                <u>Step 1</u>. To restore a backup file to your OnlyKey, ensure you have loaded the same key you used to create the backup and set the key as your backup key. Also make sure your OnlyKey is connected and unlocked.
                            </p>
                            <p>
                                <u>Step 2</u>. Hold down the #6 button on your OnlyKey for 5 seconds or more and then release. The OnlyKey light will turn off and you must re-enter your PIN to unlock the device into config mode. Open your backup file and select "Restore to OnlyKey".
                            </p>
                            <p>
                                <u>Step 3</u>. When you see the messages "Successfully loaded backup file" and "Remove and Reinsert OnlyKey to complete restore" the restore is complete. Remove and reinsert OnlyKey to complete restore.
                            </p>
                        </fieldset>

                        <br/><br/>

                        <input type="file" id="restoreSelectFile" name="restoreSelectFile" value="Select File" />
                        <br/>
                        <br/>
                        <input type="button" id="doRestore" name="doRestore" value="Restore to OnlyKey" />
                        <div id="restoreFormError" class="form-error"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <dialog id="finalStep-dialog">
        <h2>Your OnlyKey has been successfully configured.</h2>
        <h3>Please unplug and reinsert your OnlyKey to continue setting up your slots.</h3>
    </dialog>

    <dialog id="disconnected-dialog">
        <h1>Please connect your OnlyKey</h1>
    </dialog>

    <dialog id="working-dialog">
        <h1>Working...</h1>
        <h2>Please wait</h2>
    </dialog>

    <dialog id="locked-dialog">
        <h1>Your OnlyKey is locked</h1>
        <h3>Please enter your PIN</h3>
    </dialog>

    <dialog id="slot-wipe-confirm">
        <h2>WIPE OnlyKey Slot <span id="wipeCurrentSlotId">1a</span>??</h2>
        <input type="button" id="slotWipeConfirm" name="slotWipeConfirm" value="Wipe"/>
        <input type="button" id="slotWipeCancel" name="slotWipeCancel" value="Cancel"/>
    </dialog>

    <dialog id="select-private-key-dialog">
        <h2>Please choose a key</h2>

        <p>Multiple keys were extracted. Please choose which one to save.</p>

        <div id="private-key-options">
        </div>

        <input type="button" id="selectPrivateKeyConfirm" name="selectPrivateKeyConfirm" value="Save"/>
        <input type="button" id="selectPrivateKeyCancel" name="selectPrivateKeyCancel" value="Cancel"/>
        <div id="selectPrivateKeyError" class="form-error"></div>
    </dialog>

    <dialog id="slot-config-dialog">
        <a href="" class="slot-config-close">cancel [x]</a>
        <h2>OnlyKey Slot <span class="slotId">1a</span> Configuration</h2>
        <form name="slot-config-form" id="slot-config-form">
            <table>
<!--                 <tr>
                    <td>Load Defaults From Template</td>
                    <td>
                        <select id="templates" name="templates">
                            <option value="test">test</option>
                        </select>
                    </td>
                </tr> -->
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkSlotLabel" name="chkSlotLabel" value="true"/>
                            Label (up to 16 chars)
                        </label>
                    </td>
                    <td>
                        <input type="text" id="txtSlotLabel" name="txtSlotLabel" value="" maxlength="16" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkSlotUrl" name="chkSlotUrl" value="true"/>
                            URL (up to 56 chars)
                        </label>
                    </td>
                    <td>
                        <input type="text" id="txtSlotUrl" name="txtSlotUrl" value="" maxlength="56" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkDelay1" name="chkDelay1" value="true"/>
                            Delay (0-9 seconds)
                        </label>
                    </td>
                    <td>
                        <input type="text" name="numDelay1" value="" maxlength="1" style="width:1em;" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkUserName" name="chkUserName" value="true"/>
                            UserName (up to 56 chars)
                        </label>
                    </td>
                    <td>
                        <input type="text" id="txtUserName" name="txtUserName" value="" maxlength="56" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="tabReturn1" value=1/>
                            Tab
                        </label>
                        <label>
                            <input type="radio" name="tabReturn1" value=2/>
                            Return
                        </label>
                        <label>
                            <input type="radio" name="tabReturn1" value=0/>
                            None
                        </label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkDelay2" name="chkDelay2" value="true"/>
                            Delay (0-9 seconds)
                        </label>
                    </td>
                    <td>
                        <input type="text" name="numDelay2" value="" maxlength="1" style="width:1em;" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkPassword" name="chkPassword" value="true"/>
                            Password (up to 56 chars)
                        </label>
                    </td>
                    <td>
                        <input type="password" id="txtPassword" name="txtPassword" value="" maxlength="56" />
                    </td>
                </tr>
                <tr>
                    <td>Re-enter Password</td>
                    <td>
                        <input type="password" id="txtPasswordConfirm" name="txtPasswordConfirm" value="" maxlength="56" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="tabReturn2" value=2/>
                            Return
                        </label>
                        <label>
                            <input type="radio" name="tabReturn2" value=0/>
                            None
                        </label>
                    </td>
                </tr>
                <tr>
                <tr>
                    <td><br/>Options below are for two-factor authentication:</td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="tabReturn2" value=1/>
                            Tab
                        </label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkDelay3" name="chkDelay3" value="true"/>
                            Delay (0-9 seconds)
                        </label>
                    </td>
                    <td>
                        <input type="text" name="numDelay3" value="" maxlength="1" style="width:1em;" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="mode" value="googleAuthOtp"/>
                            Google Auth OTP
                        </label>
                    </td>
                    <td>
                        <input type="text" id="txt2FAUserName" name="txt2FAUserName" value=""/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="tabReturn3" value=2 checked/>
                            Return
                        </label>
                        <label>
                            <input type="radio" name="tabReturn3" value=0/>
                            None
                        </label>
                    </td>
                </tr>
                <tr>
                    <td><br/>Options below only work with Standard Edition OnlyKey:</td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="mode" value="yubikeyOtp"/>
                            Yubikey OTP
                        </label>
                        <br/>
                        <label>
                            <input type="radio" name="mode" value="u2f"/>
                            U2F
                        </label>
                        <br/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="tabReturn3" value=2/>
                            Return
                        </label>
                        <label>
                            <input type="radio" name="tabReturn3" value=0/>
                            None
                        </label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" id="slotConfigErrors">
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="button" id="slotWipe" name="slotWipe" value="Wipe"/>
                    </td>
                    <td>
                        <input type="button" id="slotSubmit" name="slotSubmit" value="Submit"/>
                    </td>
                </tr>
            </table>
        </form>
    </dialog>

    <script src="/scripts/onlyKey/OnlyKeyWizard.js"></script>
    <script src="/scripts/onlyKey/OnlyKeyComm.js"></script>
</body>
</html>
